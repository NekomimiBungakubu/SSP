<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>飲み会情報入力とプルダウンメニュー</title>
    <style>
        #eventInfo {
            margin-bottom: 20px;
        }
    </style>
    <script>
        var drinkSelections = [];
        var alertAfterNSelections = 3; // アラートを表示する選択回数を設定

        function submitEventInfo(event) {
            event.preventDefault();
            var eventDate = document.getElementById('eventDate').value;
            var eventName = document.getElementById('eventName').value;
            var sppCheck = document.getElementById('sppCheck').checked;

            // 1つ目の画面の情報を保存
            var eventInfo = {
                date: eventDate,
                name: eventName,
                spp: sppCheck
            };
            localStorage.setItem('eventInfo', JSON.stringify(eventInfo));

            // 2つ目の画面の上部に情報を表示
            displayEventInfo();

            // プルダウンメニューを表示
            document.getElementById('drinkSelectionForm').style.display = 'block';
        }

        function displayEventInfo() {
            var eventInfo = JSON.parse(localStorage.getItem('eventInfo'));
            var eventInfoDiv = document.getElementById('eventInfo');
            eventInfoDiv.innerHTML = `
                <p>飲み会を行った日: ${eventInfo.date}</p>
                <p>飲み会名: ${eventInfo.name}</p>
                <p>SPPの有無: ${eventInfo.spp ? 'あり' : 'なし'}</p>
            `;
        }

        function addDrinkSelection(event) {
            event.preventDefault();
            var selectedDrink = document.getElementById('drinkDropdown').value;
            drinkSelections.push(selectedDrink);

            // 選択結果を表示
            var selectionList = document.getElementById('selectionList');
            var listItem = document.createElement('li');
            listItem.textContent = drinkSelections.length + '. "' + selectedDrink + '"';
            selectionList.appendChild(listItem);

            // n回目の選択でアラートを表示
            if (drinkSelections.length === alertAfterNSelections) {
                alert('そろそろ人格が入れ替わります。飲酒を控えてください。');
            }

            // 新しいプルダウンメニューを作成
            var newDropdown = document.createElement('select');
            newDropdown.id = 'drinkDropdown';
            newDropdown.innerHTML = `
                <option value="">選択してください</option>
                <option value="beer">ビール</option>
                <option value="chuhai">チューハイ</option>
                <option value="wine">ワイン</option>
                <option value="cheap_wine">ワイン（安物）</option>
                <option value="sake">日本酒</option>
                <option value="cheap_sake">日本酒（安物）</option>
                <option value="other">その他</option>
            `;
            document.getElementById('drinkSelectionForm').replaceChild(newDropdown, document.getElementById('drinkDropdown'));
        }

        document.addEventListener('DOMContentLoaded', function() {
            // 2つ目の画面の情報を表示する場合
            if (localStorage.getItem('eventInfo')) {
                displayEventInfo();
                document.getElementById('drinkSelectionForm').style.display = 'block';
            }
        });
    </script>
</head>
<body>
    <form id="eventInfoForm" onsubmit="submitEventInfo(event)">
        <label for="eventDate">飲み会を行った日:</label>
        <input type="date" id="eventDate" required><br>
        <label for="eventName">飲み会名:</label>
        <input type="text" id="eventName" required><br>
        <label for="sppCheck">SPPの有無:</label>
        <input type="checkbox" id="sppCheck"><br>
        <input type="submit" value="情報を送信">
    </form>

    <div id="eventInfo"></div>

    <form id="drinkSelectionForm" onsubmit="addDrinkSelection(event)" style="display:none;">
        <select id="drinkDropdown">
            <option value="">選択してください</option>
            <option value="beer">ビール</option>
            <option value="chuhai">チューハイ</option>
            <option value="wine">ワイン</option>
            <option value="cheap_wine">ワイン（安物）</option>
            <option value="sake">日本酒</option>
            <option value="cheap_sake">日本酒（安物）</option>
            <option value="other">その他</option>
        </select>
        <input type="submit" value="追加">
    </form>

    <ul id="selectionList"></ul>
</body>
</html>